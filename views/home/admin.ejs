<link rel="stylesheet" href="lib/codemirror.css">
<link rel="stylesheet" href="theme/mbo.css">
<link rel="stylesheet" href="addon/display/fullscreen.css">
<script>
		<%
		User.find({admin: true}).exec(function(err, users) {
				if(err) {
						console.log("error: " + err);
				} else {
						if(users.length == 0) {
								res.redirect("/user/setup");
						}
				}
		});
		%>
		function deleteFolder(id){
		allFolders[id].remove();
		};
		function deleteProblem(id){
				var classname = "#li-" + id;
				$(classname).remove();
		};

		function addProblem(problem){
		var item = $("<li></li>").attr("id","li-" + problem.id).html(problem.name);
		var close = $("<a></a>").attr("class","delete").css("margin-left","5px").click(function() {
						$.post("/problem/delete", {id: problem.id}, function(problem){
						});
						deleteProblem(problem.id);
		});
				//add problem under containing folder
				//$("#l-" + problem.folder).append("<li id='li-" + problem.id + "'>" + problem.name + "</li>");
				$("#l-" + problem.folder).append(item).append(close);
				//add delete button/method to problem
		/*
		$("#li-" + problem.id).append("<a class='delete' style='margin-left: 5px;'><span class='glyphicon glyphicon-remove'></span></a>").click(function(){
						$.post("/problem/delete", {id: problem.id}, function(problem){
								alert("successfully deleted");
						});
						deleteProblem(problem.id);
				});
		*/
		};
</script>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

<script src="/js/admin.js"></script>
<style>

	#sortable { list-style-type: none; margin-top: 4px; padding: 0; width: 100%;}
	#sortable ul { list-style-type: none; margin-top: 4px; padding: 0; width: 100%;}
	#sortable ul > li { background: none; border: 0px solid white; margin-left: 5px;}

	.sortableGrip2 { cursor: move; float: left; };
	.sortableFolder {margin-top: 5px; padding-left: 0px; padding-right: 0px; }
	.panel-heading {padding-right:5px; }
	.sortableGrip { cursor: move; float: left; };
	.panel-collapse {padding:20px; }
	.panel-collapse p {margin:0 20px; padding:0; }

.spin {
  -webkit-animation: spin 1s infinite linear;
  -moz-animation: spin 1s infinite linear;
  -o-animation: spin 1s infinite linear;
  animation: spin 1s infinite linear;
     -webkit-transform-origin: 50% 58%;
         transform-origin:50% 58%;
         -ms-transform-origin:50% 58%; /* IE 9 */
}

@-moz-keyframes spin {
  from {
    -moz-transform: rotate(0deg);
  }
  to {
    -moz-transform: rotate(360deg);
  }
}

@-webkit-keyframes spin {
  from {
    -webkit-transform: rotate(0deg);
  }
  to {
    -webkit-transform: rotate(360deg);
  }
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* @group Blink */

.blink {
    -webkit-animation: blink 1s linear infinite;
    -moz-animation: blink 1s linear infinite;
    -ms-animation: blink 1s linear infinite;
    -o-animation: blink 1s linear infinite;
    animation: blink 1s linear infinite;
}

@-webkit-keyframes blink {
    0% { border: 1px solid white; }
    50% { border: 1px solid white; }
    50.01% { border: 1px solid red; }
    100% { border: 1px solid red; }
}

@-moz-keyframes blink {
    0% { border: 1px solid white; }
    50% { border: 1px solid white; }
    50.01% { border: 1px solid red; }
    100% { border: 1px solid red; }
}

@-ms-keyframes blink {
    0% { border: 1px solid white; }
    50% { border: 1px solid white; }
    50.01% { border: 1px solid red; }
    100% { border: 1px solid red; }
}

@-o-keyframes blink {
    0% { border: 1px solid white; }
    50% { border: 1px solid white; }
    50.01% { border: 1px solid red; }
    100% { border: 1px solid red; }
}

@keyframes blink {
    0% { border: 1px solid white; }
    50% { border: 1px solid white; }
    50.01% { border: 1px solid red; }
    100% { border: 1px solid red; }
}

/* @end */


body {
	padding-bottom: 20px;

}
.navigationPanel {
	padding: 0px;
	border:none;
}
form > button {
	margin-top: 10px;
}
.navbar-default {
		margin-top: 20px;
}
#folderBar {
	padding: 0px;
}
#folderBar > div {
	margin-right: 10px;
}
.alert {
		margin-top: 10px;
		margin-bottom: 0;
}
.pointbreakdown {
	float:right; 
	width:200px; 
	margin-left:5px;
	padding:5px;
}
#viewStudentsTable {
	margin-top: 20px;
	text-align: center;
}

.attemptProblem td {
	padding-left:30px
}
.attemptProblem td:last-child {
	padding-left:3px
}
.left {
	float:left;
	width: 21.5%;
}
.problem-name-first {
	width:35%;
}
.submission-name-first {
width:31.5%;
}
.left-submission {
	float:left;
	width: 22.5%;
}
.style-submission {
	margin-right:23.5%
}

ul {
	list-style-type: none;
}

#visualization {
	width:100%;
}
.visualize-row {
	width:100%;
	height:10px;
	margin:2px 0;
}
#matrixBody {
}
.matrixSquare {
	height:50px;
	width: 50px;
	float:left;
	margin: 1px;
	padding-left: 2px;
	padding-right: 2px;
	text-overflow: clip;
	white-space: nowrap;
    overflow: hidden;
    transition:height 0.2s; /* Animation time */
    -webkit-transition:height 0.2s; /* For Safari */
    clear:none;
	vertical-align: top;
	line-height: 0px;
}

.matrixSquareHover {
	margin: 0px;
	width:auto;
	height:auto;
	line-height: 250%;
	visibility: hidden;
}

.matrixSquare:hover {
	min-width: 50px;
	width: auto;
}

#refreshData {
	float: right;
	margin-top: -6px;
}

.probStudentSubmissionTableTD {
	width: 15%;	
	text-align: center;
}
#pointbreakdownSubmission {
	border: 2px solid gray;
	width:190px; 
	margin-left:5px;
	padding:8px;
	margin-bottom: 7px;
	float:right;
}

#feedbackRequestedDiv, #feedbackDisplayDiv, #feedbackSubmitDiv {
	margin: 10px;
	margin-left:0px;
	margin-right:0px;
	margin-top: 3px;
}

.console {
	background-color: #2a2b2b;
	color: #dddddd;
	padding: 3px 10px;
}
.textConsole {
	width: 100%;
	background-color: #edeff0;
}

.ISLP {
	background-color: #F7F7F7;
}

.folderCollapse p {
	margin:0px;
	padding-left: 5px;
}



</style>
<script src="lib/codemirror.js"></script>
<script src="../mode/javascript/javascript.js"></script>
<script src="../addon/selection/active-line.js"></script>
<script src="../addon/display/fullscreen.js"></script>

<% if (req.isAuthenticated() && req.user.admin) {%>

<nav style="margin-bottom: 0" class="navbar navbar-inverse" role="navigation">
	<div class="container-fluid">

		<div class="navbar-header">
	     	<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
	        <span class="sr-only">Toggle navigation</span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	      	</button>
	    </div>

	    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
	     	<ul class="nav navbar-nav">
				<li><a class="navbar-brand matrixLink" href="#matrix" data-toggle="pill">Matrix</a></li>
				<li><a class="navbar-brand editLink" href="#edit" data-toggle="pill">Edit</a></li>
				<li><a class="navbar-brand addLink" href="#addquestion" data-toggle="pill">Add</a></li>
				<li id='feedbackNav'></li>
				<li><a class="navbar-brand " href="#students" data-toggle="pill">Students</a>
				</li>
				<li><a class="navbar-brand " href="#admin" data-toggle="pill">Admins</a></li>
				<li><a class="navbar-brand " href="#settings" data-toggle="pill">Settings</a></li>
				<li><a class="navbar-brand" href="#help" data-toggle="pill">Help</a></li>
	     	</ul>

	     	<div class="navbar-right">
				<p class="navbar-text"><%= req.user.displayName %></p>
				<p class="hidden" id="userOnyen"><%= req.user.username %></p>

				<form class="navbar-form navbar-right">
					<a href="/login/logout" id="logout" class="btn btn-default">Logout</a>
				</form>
			</div>
	    </div>

		
	</div><!-- /.container-fluid -->
</nav>

<!-- Modal -->
	<div class="modal fade" id="shareSubmissionModal" role="dialog">
	    <div class="modal-dialog">
	    
	      <!-- Modal content-->
	      <div class="modal-content">
	        <div class="modal-header">
	          <button type="button" class="close" data-dismiss="modal">&times;</button>
	          <h4 class="modal-title">Share Submission?</h4>
	        </div>
	        <div class="modal-body">
	        	<b><span id="subModal"></span></b><br /><br />
				<textarea id="modalCodemirror"></textarea>
	        </div>
	        <div class="modal-footer">
	          <span id="projectSubmissionButton"></span>
	          <span id="dimissShareButton"></span>
	          <button type="button" class="btn btn-default" data-dismiss="modal">Hold</button>
	        </div>
	      </div>
	      
	    </div>
	</div>


<div class="container-fluid " style="padding-top: 4px">

	



	<!-- BODY -->
	<div class="tab-content " id="mainBody">

		<!-- MATRIX SECTION -->

		<div class="tab-pane active" id="matrix">

			<!-- SIDE BAR -->
			<div class=" navigationPanel panel panel-default col-md-3 ">
				<div id="moveMatrix">
					<div id="moveMe">
						<button type="button" class="btn btn-default" id="sortFolderButton">Edit Folders</button>
						<div class="panel-group" id="navigableFolders"></div>
						<div class="panel-group" id="sortableFolders"></div>
					</div>
				</div>
			</div>
			<!-- END SIDE BAR -->

			<div class="col-md-9">
				<div class="alert alert-danger hidden problemDeleted">
					Deleting Problem... <span class="glyphicon glyphicon-refresh spin" />
				</div>

				<!-- DISPLAY QUESTION SECTION -->
				<div class="panel panel-default ">

					<!-- DISPLAY QUESTION HEADING -->
					<div class="panel-heading">
						 <h4 class="panel-title" >
								<a data-toggle="collapse" data-parent="#accordion" href="#displayQuestionCollapse" aria-expanded="true" id="problemDisplayName"> Choose a Problem</a>
						</h4>
					</div>

					<!-- DISPLAY QUESTION BODY -->
					<div class="collapse" id="displayQuestionCollapse">
						<div class="panel-body">
							<div class="pointbreakdown">
								<div id="pointbreakdown" class=" hidden alert alert-info" >
									<b>Point Breakdown:</b><br/>
									Functionality: <span id="availablePtCorrect"></span>
									<br />
									Style: <span id="availablePtStyle"></span>
									<br />
								</div>
								<div id="submissionLimitDisplay" class=" hidden alert alert-danger" >
									<b>Submission Limit: </b><span id="maxSubmissionLimit"></span>
								</div>
							</div>
							<div id="problemDisplayBody" >
								Select a problem from the left to view more information.
							</div>
						</div>
					</div>
				</div>
				<!-- DISPLAY QUESTION SECTION END -->

				<!-- MATRIX SECTION -->
				<div class="panel panel-default ">

					<!-- MATRIX HEADING -->
					<div class="panel-heading">
						<h4 class="panel-title">
							<a data-toggle="collapse" data-parent="#accordion" href="#problemMatrix" aria-expanded="true" >Matrix</a>
							<button style="float:right;margin-top:-6px;" class="btn btn-primary btn-sm" id="clearShareRequests" data-toggle="tooltip" data-placement="top" title="Dimiss all Share Requests">
								<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>
							</button>

							<select id="studentListRefresh" style="float:right;width:auto;margin:0px;margin-top:-8px;" class="form-control">
								<option value="0">Manual</option>
								<option value="2">2 seconds DELETE</option>
								<option value="10">10 seconds</option>
								<option value="20">20 seconds</option>
								<option value="60">1 minute</option>
								<option value="180">3 minutes</option>
							</select>

						</h4>
					</div>

					<!-- MATRIX BODY -->
					<div class="panel-collapse " id="problemMatrix">
						<div class="panel-body" style="padding:2px">
							<div id="matrixBody">
							</div>
						</div>
					</div>
				</div>

				<!-- MATRIX SECTION END -->

				<!-- STUDENT PROGRESS SECTION -->
				<div class="panel panel-default">
					<div class="panel-heading">
						<h4 class="panel-title">
							<a data-toggle="collapse" data-parent="#accordion" href="#allStudents1ProblemTableCollapse" aria-expanded="true" >Student Attempts</a>
							<span id="function" class="label label-info" data-toggle="tooltip" data-placement="top" title="Students with full correct points">0%</span><span id="style" class="label label-success" data-toggle="tooltip" data-placement="top" title="Students with full style points">0%</span>
							<button class="btn btn-primary btn-sm" id="refreshData" data-toggle="tooltip" data-placement="top" title="This panel does not update with the matrix above.   Refresh to fill progress bar and table with most recent data.">Refresh</button>
						</h4>
					</div>
					<div class="panel-collapse collapse" id="allStudents1ProblemTableCollapse">
						<!-- PROGRESS BAR SECTION -->
						<div class="progress" style="margin-bottom:0px;">
							<div class="progress-bar progress-bar-success" style="width: 0%" id="pbp-green" data-toggle="tooltip" data-placement="top" title="Students who earned full points">
								<span class="sr-only">35% Complete (success)</span>
							</div>
							<div class="progress-bar progress-bar-warning progress-bar-striped" style="width: 0%" id="pbp-yellow" data-toggle="tooltip" data-placement="top" title="Students who submitted but did not earn full points">
								<span class="sr-only">20% Complete (warning)</span>
							</div>
							<div class="progress-bar progress-bar-danger" style="width: 0%" id="pbp-red">
								<span class="sr-only">10% Complete (danger)</span>
							</div>
						</div>
						<!-- PROGRESS BAR SECTION END -->
						<div id="allStudents1ProblemTable">
						</div>
					</div>
				</div>
				<!-- STUDENT PROGRESS SECTION ENDS -->
			</div>

		</div>
		<!-- MATRIX SECTION ENDS -->

		<!-- EDIT SECTION -->
		<div class="tab-pane " id="edit">

			<!-- SIDE BAR -->
			<div class="navigationPanel panel panel-default col-md-3 ">
				<div id="moveEdit">
				</div>
			</div>
			<!-- END SIDE BAR -->

			<div class="col-md-9">
				<div class="alert alert-danger hidden problemDeleted">
					Deleting Problem... <span class="glyphicon glyphicon-refresh spin" />
				</div>
				<!-- EDIT QUESTION SECTION -->
				<div class="panel panel-default" id="editQuestionpanel">

					<!-- EDIT QUESTION HEADING -->
					<div class="panel-heading">
						<h4 class="panel-title">
							<a data-toggle="collapse" data-parent="#accordion" href="#editQuestionCollapse" aria-expanded="true" >Edit</a>
						</h4>
					</div>

					<!-- EDIT QUESTION BODY -->
					<div class="" id="editQuestionCollapse">
						<div class="panel-body">
							<p id="editPlaceholder">Select a problem from the left to edit it</p>
							<form id="editForm" class="form hidden">
								<div class="row">
									<div class="form-group">
										<div class="col-md-3">
											<label class="control-label" for="editType">Type</label>
											<select id="editType" name="editType" class="form-control">
												<option value="twit">twit</option>
												<option value="diy">diy</option>
												<option value="wall">wall</option>
												<option value="exam">exam</option>
											</select>
										</div>
										<div class="col-md-3">
											<label class="control-label" for="editPhase">Phase</label>
											<select id="editPhase" name="editPhase" class="form-control">
												<option value="0">Past</option>
												<option value="1">Present</option>
												<option value="2">Future</option>
											</select>
										</div>
										<div class="col-md-3">
											<label class="control-label">Function Points</label>
											<input id="editCorrectPoints" class="form-control">
										</div>
										<div class="col-md-3">
											<label class="control-label">Style Points</label>
											<input id="editStylePoints" class="form-control">
										</div>
										<div class="col-md-3">
											<label class="control-label" for="editProblemLanguage">Language</label>
											<select name="editLanguage" id="editLanguageDropdown" class="form-control">
												<option value="javascript">JavaScript</option>
												<option value="java">Java</option>
											</select>
										</div>
										<div class="col-md-3">
											<label class="control-label" for="editMode">Mode</label>
											<select name="editMode" id="editModeDropdown" class="form-control">
												<option value="true">Test</option>
												<option value="false">Live</option>
											</select>
										</div>
										<div class="col-md-3">
											<label class="control-label" for="editMaxSubmissions">Submission Limit</label>
									     	<input type="checkbox" id="editMaxSubmissions">
											<input disabled id="editSubmissionLimit" class="form-control">
										</div>
									</div>
								</div>
								<div class="row">
									<div class="form-group">
										<div class="col-md-6">
											<label class="control-label" for="editProblemName">Name</label>
											<input id="editProblemName" name="editName" type="text" class="form-control"></input>
										</div>
										<div class="col-md-6">
											<label name="editFolder" class="control-label" for="folder">Folder</label>
											<select id="editFolderDropdown" class="form-control">  </select>
										</div> 
									</div>
								</div>
								<label class="control-label" for="editDescription">Description</label>
								<textarea name="editDescription" id="editDescription" class="form-control"></textarea>
								<label class="control-label" for="editOnSubmit">Function to run on submission</label>
								<textarea name="editOnSubmit" id="editOnSubmit" class="form-control" 
										 style="font-family:Consolas, monospace"></textarea>
								<div id="editProblemError"></div>

								<button class="btn btn-success form-control" id="editProblem">Update Problem</button>

							</form>
						</div>
					</div>
				</div>
				<!-- EDIT QUESTION SECTION END -->
				<!--
				<button class="btn btn-danger form-control hidden" id="deleteProblem">Delete Problem</button>
				-->
			</div>

		</div>
		<!-- EDIT SECTION ENDS -->


		<!-- ADD QUESTION SECTION -->
		<div class=" tab-pane " id="addquestion">
			<div class=" navigationPanel panel panel-default col-md-3 ">
				<div id="moveAdd">
				</div>
			</div>
			<div class="col-md-9">
				<div  class="panel panel-default tab-pane " id="addquestion">
					<div class="panel-heading">
						Add a new question
					</div>
					<div class="panel-body">
						<form id="addProblemForm" class="form">
							<div class="row">
								<div class="form-group">
									<div class="col-md-3">
										<label class="control-label" for="type">Type</label>
										<select  id="type" class="form-control">
											<option value="twit">twit</option>
											<option value="diy">diy</option>
											<option value="wall">wall</option>
											<option value="exam">exam</option>
										</select>
									</div>
									<div class="col-md-3">
										<label class="control-label" for="phase">Phase</label>
										<select  id="phase" class="form-control">
											<option value="2">Future</option>
											<option value="1">Present</option>
											<option value="0">Past</option>
										</select>
									</div>
									<div class="col-md-3">
										<label class="control-label">Function Points</label>
										<input id="correctPoints" value=1 class="form-control">
									</div>
									<div class="col-md-3">
										<label class="control-label">Style Points</label>
										<input id="stylePoints" value=1 class="form-control">
									</div>
									<div class="col-md-3">
										<label class="control-label" for="language">Language</label>
										<select id="languageDropdown" class="form-control">
											<option value="javascript">JavaScript</option>
											<option value="java">Java</option>
										</select>
									</div>
									<div class="col-md-3">
										<label class="control-label" for="mode">Mode</label>
										<select name="mode" id="modeDropdown" class="form-control">
											<option value="true">Test</option>
											<option value="false">Live</option>
										</select>
									</div>
									<div class="col-md-3">
										<label class="control-label" for="maxSubmissions">Submission Limit</label>
								     	<input type="checkbox" id="maxSubmissions">
										<input disabled id="submissionLimit" class="form-control">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="form-group">
									<div class="col-md-6">
										<label class="control-label" for="name">Name</label>
										<input  id="problemName" type="text" class="form-control">
									</div>
									<div class="col-md-6">
										<label class="control-label" for="folder">Folder</label>
										<select id="folderDropdown" class="form-control"> </select>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="form-group">
									<div class="col-md-12">
										<label class="control-label" for="description">Description</label>
										<textarea id="description" class="form-control"></textarea>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="form-group">
									<div class="col-md-12">
										<label class="control-label" for="onSubmit">Function to run on submission</label>
										<textarea id="onSubmit" class="form-control" 
											 style="font-family:Consolas, monospace">
										</textarea>
									</div>
								</div>
							</div>
							<button class="btn btn-success form-control" id="addProblem">Add Problem</button>
						</form>
					</div>
				</div>
				<div id="newProblemError"></div>
			</div>
		</div>
		<!-- ADD QUESTION SECTION ENDS -->
		
		<!-- SUBMISSION SECTION -->
		<div class="tab-pane" id="submission">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4 class="panel-title">
						<a data-toggle="collapse" data-parent="#accordion" href="#submissionCollapse" id="submissionTitle">
							Collapsible
						</a>
					</h4>
				</div>
				<div id="submissionCollapse" class="panel-collapse collapse in submissionCollapse">
					<div class="panel-body">
						<div id="pointbreakdownSubmission">
			  				Functionality <span id="ScorrectCheck" class="pull-right"></span><span class="badge pull-right"><span id="SearnedPtCorrect">0</span>/<span id="SavailablePtCorrect"></span></span>
			  				<br />
			  				</span>Style <span id="SstyleCheck" class="pull-right"></span><span class="badge pull-right"><span id="SearnedPtStyle">0</span>/<span id="SavailablePtStyle"></span></span>
			  				<br />
		  				</div>
						Created By: <span id="submissionCreatedBy"></span><br />
						Problem: <span id="submissionProblem"></span><br />
						Created At: <span id="submissionCreatedAt"></span><br /><br />
						<div id="submissionProject"></div>

					</div>
				</div>
			</div>		
			<div class="row">
				<div class="col-sm-6" style="padding-right:0px;">

				  <!-- Nav tabs -->
				  <ul class="nav nav-tabs" role="tablist" id="submissionTabMenu">
				    <li id="submissionTabSubmission" role="presentation" class="active"><a href="#submissionTab" aria-controls="submissionTab" role="tab" data-toggle="tab">Submission</a></li>
				    <li id="submissionTabFeedback" role="presentation"><a href="#feedbackTab" aria-controls="feedbackTab" role="tab" data-toggle="tab">Feedback</a></li>
				  </ul>

				  <!-- Tab panes -->
				  <div class="tab-content">
				    <div role="tabpanel" class="tab-pane active" id="submissionTab">
						<div id="feedbackRequestAlertSubTab" class="alert alert-danger " style="margin-left:0px;margin-right:0px;" >
							<span class="feedbackRequestTime"></span>
							<div class="fbRequestMsg" style="clear:both;margin-top:10px;"></div>
						</div>
						<div class="console" style="margin-top:10px;">
						Test Results Console
				        </div>
						<textarea id="fbConsole" class="textConsole" readonly>
				    	</textarea>
						<div id="readOnlySubmission">
							<textarea id="codemirror"></textarea>
						</div>
						<div id="feedbackSubmitDiv">
							<textarea name="fbCodemirror" id="fbCodemirror"></textarea>

							<textarea name="fbResponseMessage" id="fbResponseMessage" class="form-control" placeholder="Enter message for student here..."></textarea>
							
							<button id="submitFeedbackButton" class="btn btn-primary form-control" >Submit Feedback</button>
						</div>
				    </div>
				    <div role="tabpanel" class="tab-pane" id="feedbackTab">
						<div id="feedbackRequestAlertFbTab" class="alert alert-danger " style="margin-left:0px;margin-right:0px;" >
							<span class="feedbackRequestTime"></span>
							<div class="fbRequestMsg" style="clear:both;margin-top:10px;"></div>
						</div>
						<div class="alert alert-success" style="margin-bottom: 10px">
							<span id="feedbackResponseTime"></span>
							<div id="fbResponseMsg" style="clear:both;margin-top:10px;"></div>
						</div>
						<textarea id="fbCodemirrorReadOnly"></textarea>

				    </div>
				  </div>						
				</div>
				<div class="col-sm-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4 class="panel-title">
								<a data-toggle="collapse" data-parent="#accordion" href="#relatedSubmissionCollapse" id="submissionTitle">
									Related Submissions
								</a>
							</h4>
						</div>
						<div id="relatedSubmissionCollapse" class="panel-collapse collapse in submissionCollapse">
							<table class="table" style='margin-bottom:0px;'>
							<thead><tr id="relatedSubmissionHead"></tr>
							</thead>
							<tbody id="relatedSubmissions"> </tbody>
							</table>
						</div>
					</div>	
				</div>			
			</div>

		</div>
		<!-- SUBMISSION SECTION ENDS -->

		<!-- PROGRESS SECTION 
		<div class="tab-pane" id="progress">
			<h1>Progress</h1>
			<div id="visualization"></div>
		</div>
		 PROGRESS SECTION ENDS -->

		<!-- ADMIN SECTION -->
		<div class="tab-pane" id="admin">
			<div class="col-md-5">
				<div class="panel panel-default ">
					<div class="panel-heading">Manage admins</div>
	 
					 <ul id="admins" class="list-group"></ul>

					 <div class="panel-body">
						 <div class="input-group">
							<input type="text" id="newAdmin" class="form-control" placeholder="Type username..."></input>
							<span class="input-group-btn">
								 <button type="submit" id="newAdminBtn" class="btn btn-default"><span class="glyphicon glyphicon-plus" style="color:green;"></span></button>
							</span>
						 </div>
						 <div id="newAdminError"></div>
					 </div>
				</div>
				<div class="alert alert-danger hidden" id="namesHaveChanged">
					Please refresh page to observe name changes.
				</div>
			</div>
		</div>
		<!-- ADMIN SECTION ENDS -->

		<!-- LIST STUDENTS SECTION -->
		<div class="tab-pane" id="students">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4 class="panel-title">Students
						<form class="form-inline pull-right">
							<div class="form-group">
								<input type="text" class="form-control" id="onyen" placeholder="Enter onyen">
								<!--<button href="#individualStudent" type="button" class="btn btn-primary"  data-toggle='pill' id="onyenSearchButton">Submit</button>-->
								<a href="#individualStudent" data-toggle="pill" class="btn btn-info" role="button" id="onyenSearchButton">Search</a>
								<a class="btn btn-primary" id="refreshStudentListScores">Refresh</a>
								<a class="btn btn-default" id="exportCSV">CSV</a>
							</div>
						</form>
					</h4>
				</div>
				
				<div id="viewStudentsList">
					<div class="panel-body">
						Loading students...
					</div>
				</div>
			</div>
		</div>
		<!-- LIST STUDENTS SECTION ENDS -->

		<!-- INDIVIDUAL STUDENT SECTION -->
		<div class="tab-pane" id="individualStudent">
			<h1 id="individualName" style="margin-left:15px"></h1>
			<div id="individualFeedback" class="col-md-3">
			</div>

			<div class="col-md-9">
				<!-- PROGRESS BAR-->
				<div style="clear:both;">

					<button type="button" class="btn btn-primary" disabled="disabled" id="studentRefresh" style="float:right;font-size:12pt;padding:4px;"  data-toggle="tooltip" data-placement="top" title="Reload from database"><span class='glyphicon glyphicon-refresh' id="studentRefreshGlyph"></button>

					<button type="button" class="btn btn-primary" id="studentScoreButton" style="font-size:12pt;float:right;padding:4px;" data-toggle="tooltip" data-placement="top" title="Recompute Score"></button>

					<div id="individualProgessBar" class="hidden" style="margin-top:0px;"></div>

				</div>

				<!--SUBMISSION LIST-->
				<div class="panel-group" id="individualSubmissionList" ></div>
			</div>

		</div>
		<!-- INDIVIDUAL STUDENT SECTION ENDS -->

		<!-- HELP SECTION -->
		<div class="tab-pane" id="help">
			<h1>Help</h1>
			Looking for help? You've come to the right place!
			<h3>Using the left menu bar</h3>
			The left menu bar is identical to what students will see in their interface. You can click a folder to see the problems inside it and then click a problem to load the problem view in the space to the right. Rearrange, add, and delete folders and problems by toggling the "Edit Folders" button at the top of the menu. Add a problem by clicking the "Add Problem" button at the top of the menu.

			<h3>View Progress and Edit a Specific Problem</h3>
			After clicking a problem in the left menu it will load on the right. There you can edit the question name, rubric and other details as well as see student progress on the problem. Click on the number of submissions beside a student's name to see timestamps and grades for each of his/her submissions. Clicking the student's name will take you to the Student Progress page. Clicking the timestamp of a submission will take you to the code that the student wrote.

			<h3>View Student Progress</h3>
			The "Students" tab on the top navbar will take you to a comprehensive list of students, which is searchable by onyen. Clicking on a student's name takes you to a list of all the problems they have solved, which can be expanded to show individual submission information similar to the Problem View pages when the problem name is clicked. Clicking a submission's timestamp will bring you to the code that the student submitted.

			<h3>Exploring Specific Submissions</h3>
			Once you are on the page showing the code that a student submitted for a problem, you can show/hide personal information about the student in case you want to display their code for the class to look at. You can also find a list of all of that student's other submissions for that problem at the bottom of the page.

			<h3>Grading Student Submissions</h3>
			Below is a template for generating scores for students.  The functions fail.f() and fail.s() deduct functionality and style points (respectively).  They take 2 parameters: the message to append to the console and the number of points to deduct.  Leaving the message blank ("") will deduct points without appending a message.  When done checking for errors, fail.done() declares what message the user will see in the console if there were no errors.

			<pre>
var soln_inputs = [ [ ] ];
var soln_outputs = [ ["Hello World"] ];

function totalChecker (err, user_outputs, truVec ) {

  //Functional Tests
  if (err) { 
      fail.f("There was an error in your code: " + err.msg,5);  //subtract 5 functional points
      fail.s("",5); //substract 5 style points
  }
  else {
      for(var i=0; i&lt;truVec.length; i++) { 
      	truVec[i] || fail.f("failed functional correctness",5); //subtract 5 functional points for each
      }
  }

  //Style Tests
  if (style.nDV != 1) { fail.s("Declare exactly 1 variable",3); } 
  if (style.nDF != 1) { fail.s("One function to run is required",2); }

  //Success Message
  fail.done("Good job!"); //Message seen if no points deducted.
}

// make it so
batch.exec ( code, soln_inputs, soln_outputs, totalChecker);      
			</pre>


		</div>
		<!-- HELP SECTION ENDS -->

		<!-- SETTINGS SECTION -->
		<div class="tab-pane" id="settings">
			<h1>Settings</h1>
			<div id="feedbackToggle" ></div>
			<div id="shareToggle" ></div>

		</div>
		<!-- SETTINGS SECTION ENDS -->

		<!-- FEEDBACK SECTION -->
		<div class="tab-pane" id="feedback">
			<div class="col-md-5" style="padding:0px;">
				<table class="table" style='margin-bottom:0px;'>
				<thead>
				<tr><th>Submission</th>  <th>User</th>  <th>Problem</th>
				<th>Func</th> <th>Style</td>
				</tr>
				</thead>
				<tbody id="feedbackDash"> </tbody>
				</table>
			</div>

			<div id="fbDashBody" class="hidden col-md-7">
				<div id="instructions" class='panel panel-default' style="margin-bottom:3px">
		      		<div class='panel-heading'> 
						<h3 class='panel-title'><span id="desc-title">Problem</span></h3>
		      		</div>
					<div class='panel-body'> 
		  				<div id="desc-body" >
	 						Description
						</div>
		    		</div>
		    	</div>

				<div class="alert alert-warning" style="margin-bottom: 6px;">
					<span id="fbDashRequestTime"></span><span id="fbDashRequester"></span>
					<div id="fbDashRequestMsg" style="margin-top:10px;clear:both;">Student Request Message</div>
				</div>
				<div >
					<div class="console">
					Test Results Console
			        </div>
					<textarea id="fbDashConsole" class="textConsole" readonly>
			    	</textarea>
			   
					<textarea id="fbDashCodemirror"></textarea>
					<textarea name="fbResponseMessage" id="fbResponseMessageDash" class="form-control" placeholder="Enter message for student here..."></textarea>
					
					<button id="submitFeedbackButtonDash" class="btn btn-primary form-control" >Submit Feedback</button>
				</div>
			</div>

			<div class='alert alert-success hidden col-md-7' id='fbDashSuccess' role='alert'>Feedback Submitted!</div>

		</div>
		<!-- FEEDBACK SECTION ENDS -->


	</div>
	<!-- BODY ENDS -->

<!--Admin section ends-->
<%} else if (!req.isAuthenticated()) {%>
	 <% res.redirect("/login?d=admin"); %>
<%} else {%>
	<nav class="navbar navbar-default">
			<div class="container-fluid">
					<div class="navbar-header">
							<a class="navbar-brand" href="#">Admin Page</a>
					</div>
					<form class="navbar-form navbar-right">
							<a href="/login/logout" id="logout" class="btn btn-default">Logout</a>
					</form>
			</div>
 </nav>
 <p>You must be an admin to view this page</p>
<%}%>
</div>

